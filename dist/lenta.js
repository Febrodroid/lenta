define("lenta/mixins/data-options",[],function(){return{optionsPrefix:"lenta",parseOptions:function(){var e=this,t=this.$el.data()||{},n=new RegExp("^"+this.optionsPrefix+"([a-zA-Z]+)");return $.each(t,function(r,i){t.hasOwnProperty(r)&&n.test(r)&&(shortName=r.match(n)[1].replace(/[A-Z]/,function(e){return(e||"").toLowerCase()}),e.options[shortName]=i)}),this}}}),define("lenta/slide",["backbone","lenta/mixins/data-options"],function(e,t){var n=e.View.extend({options:{width:0,height:0,maxWidth:null},initialize:function(){this.parseOptions()},getOffset:function(){var e={x:this.$el.outerWidth(!0)-this.$el.width(),y:this.$el.outerHeight(!0)-this.$el.height()};return e},getAspectRatio:function(){var e=this.options.aspectRatio;return e||(e=this.options.width/this.options.height),e},getOuterWidth:function(){return this.$el.outerWidth(!0)},getPosition:function(){return this.$el.position()},resize:function(e){var t=this.getOffset();e-=t.y;var n=Math.floor(e*this.getAspectRatio());if(this.options.maxWidth&&this.options.maxWidth<n)var n=this.options.maxWidth;return this.$el.css({height:e,width:n}),this}});return _.extend(n.prototype,t),n}),define("lenta",["backbone","lenta/slide","lenta/mixins/data-options"],function(e,t,n){var r=e.View.extend({timerMoveOnResize:null,options:{height:0,sliderSelector:".lenta-viewport > ul",slidesSelector:".lenta-viewport > ul > li",prevBtnSelector:".lenta-prev",nextBtnSelector:".lenta-next",transitionSpeed:"fast",index:0,onMovingCssClass:"moving",onFocusCssClass:"focus",aspectRatio:null},initialize:function(){_.bindAll(this),this.parseOptions(),this.slider=this.$(this.options.sliderSelector),this.prevBtn=this.$(this.options.prevBtnSelector),this.nextBtn=this.$(this.options.nextBtnSelector),this.nextBtn.on("click",this.next),this.prevBtn.on("click",this.prev),this.$(this.options.slidesSelector).on("click",this.toSlide),this.on("moving",this.initControls),$(window).resize(this.onWindowResize)},onWindowResize:function(){var e=this;this.resize(),this.timerMoveOnResize&&(clearTimeout(this.timerMoveOnResize),this.timerMoveOnResize=null),this.timerMoveOnResize=setTimeout(function(){e.move(e.options.index)},300)},initControls:function(){this.options.index+1>=this.slides.length?this.nextBtn.hide():this.nextBtn.show(),this.options.index-1<0?this.prevBtn.hide():this.prevBtn.show()},toSlide:function(e){var t=$(e.currentTarget).hasClass(this.options.onFocusCssClass);if(!t){var n=this.$el.find(this.options.slidesSelector).index(e.currentTarget);n+1<=this.slides.length&&n>=0&&this.move(this.options.index=n)}},prev:function(e){e.preventDefault(),this.options.index-1>=0&&this.move(--this.options.index)},next:function(e){e.preventDefault(),this.options.index+1<this.slides.length&&this.move(++this.options.index)},move:function(e){var t=this;if(this.$el.hasClass(this.options.onMovingCssClass))return!1;this.trigger("moving");var n=this.slides[e];if(n){this.$el.addClass(this.options.onMovingCssClass);var r=this.$el.width()/2-(n.getOuterWidth()/2+n.getPosition().left),i=0,s=this.$el.width()-this.slider.width();this.slider.animate({left:Math.max(Math.min(i,r),s>0?0:s)},this.options.transitionSpeed,function(){t.$el.removeClass(t.options.onMovingCssClass),t.setFocus(n),t.trigger("moved")})}},setFocus:function(e){this.$el.find(this.options.slidesSelector).removeClass(this.options.onFocusCssClass),e.$el.addClass(this.options.onFocusCssClass)},resize:function(){var e=this;if(this.options.aspectRatio){var t=this.$el.parent(),n=Math.min(t.width()/this.$el.width(),t.height()/this.$el.height()),r=this.$el.height()*n;r>this.options.height&&(r=this.options.height),this.$el.width(r*this.options.aspectRatio).height(r)}var i=0;return _.invoke(this.slides,function(){this.resize(e.$el.height(),e.$el.width()),i+=this.getOuterWidth()}),this.slider.width(i),this},render:function(){return this.$el.css({position:"relative","max-height":this.options.height}),this.slides=this.$(this.options.slidesSelector).map(function(e,n){return(new t({el:$(n)})).render()}),this.resize().move(this.options.index),this.$el.removeClass("loading"),this}});return _.extend(r.prototype,n),r});